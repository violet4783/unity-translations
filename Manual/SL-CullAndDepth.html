<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: ShaderLab culling and depth testing</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://docs.unity3d.com/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1586228985"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1586228985"></script><script type="text/javascript" src="docdata/toc.js?ts=1586228985"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1586228985"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1586228985">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="graphics" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2019.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/SL-CullAndDepth.html">English</a></li>
<li><a href="/ja/current/Manual/SL-CullAndDepth.html">日本語</a></li>
<li><a href="/es/current/Manual/SL-CullAndDepth.html">Español</a></li>
<li><a href="/kr/current/Manual/SL-CullAndDepth.html">한국어</a></li>
<li><a href="/ru/current/Manual/SL-CullAndDepth.html">Русский</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2019.3</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/SL-CullAndDepth.html">English</a></li>
<li><a href="/ja/current/Manual/SL-CullAndDepth.html">日本語</a></li>
<li><a href="/es/current/Manual/SL-CullAndDepth.html">Español</a></li>
<li><a href="/kr/current/Manual/SL-CullAndDepth.html">한국어</a></li>
<li><a href="/ru/current/Manual/SL-CullAndDepth.html">Русский</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2019.3)</a></li>
<li><a href="Graphics.html">Graphics</a></li>
<li><a href="Shaders.html">Meshes, Materials, Shaders and Textures</a></li>
<li><a href="ShadersOverview.html">Writing Shaders</a></li>
<li><a href="SL-Reference.html"> Shader Reference</a></li>
<li><a href="SL-Shader.html">ShaderLab Syntax</a></li>
<li><a href="SL-SubShader.html">ShaderLab: SubShader</a></li>
<li><a href="SL-Pass.html">ShaderLab: Pass</a></li>
<li>ShaderLab culling and depth testing</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SL-Pass.html"></a></span><div class="tip">ShaderLab: Pass</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="SL-Blend.html"></a></span><div class="tip">ShaderLab: Blending</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>ShaderLab culling and depth testing</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<figure>
<img src="../uploads/SL/PipelineCullDepth.png" alt="">
</figure>

<p>Culling is an optimization that does not render polygons facing away from the viewer. All polygons have a front and a back side. Culling makes use of the fact that most objects are closed; if you have a cube, you will never see the sides facing away from you (there is always a side facing you in front of it) so Unity doesn’t need to draw the sides facing away. Hence the term: Backface culling.</p>

<p>The other feature that makes <span class="tooltip"><strong>rendering</strong><span class="tooltiptext">The process of drawing graphics to the screen (or to a render texture). By default, the main camera in Unity renders its view to the screen. <a href="GraphicsOverview.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Rendering">Glossary</a></span></span></span> looks correct is Depth testing. Depth testing makes sure that only the closest surface objects are drawn in a <span class="tooltip"><strong>Scene</strong><span class="tooltiptext">A Scene contains the environments and menus of your game. Think of each unique Scene file as a unique level. In each Scene, you place your environments, obstacles, and decorations, essentially designing and building your game in pieces. <a href="CreatingScenes.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Scene">Glossary</a></span></span></span>.</p>

<h2>Syntax</h2>

<h3>Cull</h3>

<pre><code>Cull Back | Front | Off
</code></pre>

<p>Controls which sides of polygons should be culled (not drawn)</p>

<ul>
<li>
<strong>Back</strong> Don’t render polygons that are facing away from the viewer <em>(default)</em> i.e. back-facing polygons are culled.</li>
<li>
<strong>Front</strong> Don’t render polygons that are facing towards the viewer. Used for turning objects inside-out.</li>
<li>
<strong>Off</strong> Disables culling - all faces are drawn. Used for special effects.</li>
</ul>

<h3>ZWrite</h3>

<pre><code>ZWrite On | Off
</code></pre>

<p>Controls whether <span class="tooltip"><strong>pixels</strong><span class="tooltiptext">The smallest unit in a computer image. Pixel size depends on your screen resolution. Pixel lighting is calculated at every screen pixel. <a href="LightPerformance">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#pixel">Glossary</a></span></span></span> from this object are written to the <span class="tooltip"><strong>depth buffer</strong><span class="tooltiptext">A memory store that holds the z-value depth of each pixel in an image, where the z-value is the depth for each rendered pixel from the projection plane. <a href="class-RenderTexture.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#depthbuffer">Glossary</a></span></span></span> (default is <em>On</em>). If you’re drawing solid objects, leave this on. If you’re drawing semitransparent effects, switch to <code>ZWrite Off</code>. For more details read below.</p>

<h3>ZTest</h3>

<pre><code>ZTest Less | Greater | LEqual | GEqual | Equal | NotEqual | Always
</code></pre>

<p>How should depth testing be performed. Default is <em>LEqual</em> (draw objects in from or at the distance as existing objects; hide objects behind them).</p>

<h3>Offset</h3>

<pre><code>Offset Factor, Units
</code></pre>

<p>Allows you specify a depth offset with two parameters. <em>factor</em> and <em>units</em>. <em>Factor</em> scales the maximum Z slope, with respect to X or Y of the polygon, and <em>units</em> scale the minimum resolvable depth buffer value. This allows you to force one polygon to be drawn on top of another although they are actually in the same position. For example <code>Offset 0, -1</code> pulls the polygon closer to the <span class="tooltip"><strong>camera</strong><span class="tooltiptext">A component which creates an image of a particular viewpoint in your scene. The output is either drawn to the screen or captured as a texture. <a href="CamerasOverview.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Camera">Glossary</a></span></span></span> ignoring the polygon’s slope, whereas <code>Offset -1, -1</code> will pull the polygon even closer when looking at a grazing angle.</p>

<h2>Examples</h2>

<p>This object will render only the backfaces of an object:</p>

<pre><code>Shader &quot;Show Insides&quot; {
    SubShader {
        Pass {
            Material {
                Diffuse (1,1,1,1)
            }
            Lighting On
            Cull Front
        }
    }
}
</code></pre>

<p>Try to apply it to a cube, and notice how the geometry feels all wrong when you orbit around it. This is because you’re only seeing the inside parts of the cube.</p>

<h3>Transparent shader with depth writes</h3>

<p>Usually <a href="shader-TransparentFamily.html">semitransparent shaders</a> do not write into the depth buffer. However, this can create draw order problems, especially with complex non-convex meshes. If you want to fade in &amp; out meshes like that, then using a <span class="tooltip"><strong>shader</strong><span class="tooltiptext">A small script that contains the mathematical calculations and algorithms for calculating the Color of each pixel rendered, based on the lighting input and the Material configuration. <a href="Shaders.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Shader">Glossary</a></span></span></span> that fills in the depth buffer before rendering transparency might be useful.</p>

<figure>
<img src="../uploads/Main/TransparentDiffuseZWrite.png" alt="Semitransparent object; left: standard Transparent/Diffuse shader; right: shader that writes to depth buffer.">
<figcaption>Semitransparent object; left: standard Transparent/Diffuse shader; right: shader that writes to depth buffer.</figcaption>
</figure>

<pre><code>Shader &quot;Transparent/Diffuse ZWrite&quot; {
Properties {
    _Color (&quot;Main Color&quot;, Color) = (1,1,1,1)
    _MainTex (&quot;Base (RGB) Trans (A)&quot;, 2D) = &quot;white&quot; {}
}
SubShader {
    Tags {&quot;Queue&quot;=&quot;Transparent&quot; &quot;IgnoreProjector&quot;=&quot;True&quot; &quot;RenderType&quot;=&quot;Transparent&quot;}
    LOD 200

    // extra pass that renders to depth buffer only
    Pass {
        ZWrite On
        ColorMask 0
    }

    // paste in forward rendering passes from Transparent/Diffuse
    UsePass &quot;Transparent/Diffuse/FORWARD&quot;
}
Fallback &quot;Transparent/VertexLit&quot;
}
</code></pre>

<h3>Debugging Normals</h3>

<p>The next one is more interesting; first we render the object with normal vertex lighting, then we render the backfaces in bright pink. This has the effects of highlighting anywhere your normals need to be flipped. If you see physically-controlled objects getting ‘sucked in’ by any meshes, try to assign this shader to them. If any pink parts are visible, these parts will pull in anything unfortunate enough to touch it.</p>

<p>Here we go:</p>

<pre><code>Shader &quot;Reveal Backfaces&quot; {
    Properties {
        _MainTex (&quot;Base (RGB)&quot;, 2D) = &quot;white&quot; { }
    }
    SubShader {
        // Render the front-facing parts of the object.
        // We use a simple white material, and apply the main texture.
        Pass {
            Material {
                Diffuse (1,1,1,1)
            }
            Lighting On
            SetTexture [_MainTex] {
                Combine Primary * Texture
            }
        }

        // Now we render the back-facing triangles in the most
        // irritating color in the world: BRIGHT PINK!
        Pass {
            Color (1,0,1,1)
            Cull Front
        }
    }
}
</code></pre>

<h3>Glass Culling</h3>

<p>Controlling Culling is useful for more than debugging backfaces. If you have transparent objects, you quite often want to show the backfacing side of an object. If you render without any culling (<strong>Cull Off</strong>), you’ll most likely have some rear faces overlapping some of the front faces.</p>

<p>Here is a simple shader that will work for convex objects (spheres, cubes, car windscreens).</p>

<pre><code>Shader &quot;Simple Glass&quot; {
    Properties {
        _Color (&quot;Main Color&quot;, Color) = (1,1,1,0)
        _SpecColor (&quot;Spec Color&quot;, Color) = (1,1,1,1)
        _Emission (&quot;Emmisive Color&quot;, Color) = (0,0,0,0)
        _Shininess (&quot;Shininess&quot;, Range (0.01, 1)) = 0.7
        _MainTex (&quot;Base (RGB)&quot;, 2D) = &quot;white&quot; { }
    }

    SubShader {
        // We use the material in many passes by defining them in the subshader.
        // Anything defined here becomes default values for all contained passes.
        Material {
            Diffuse [_Color]
            Ambient [_Color]
            Shininess [_Shininess]
            Specular [_SpecColor]
            Emission [_Emission]
        }
        Lighting On
        SeparateSpecular On

        // Set up alpha blending
        Blend SrcAlpha OneMinusSrcAlpha

        // Render the back facing parts of the object.
        // If the object is convex, these will always be further away
        // than the front-faces.
        Pass {
            Cull Front
            SetTexture [_MainTex] {
                Combine Primary * Texture
            }
        }
        // Render the parts of the object facing us.
        // If the object is convex, these will be closer than the
        // back-faces.
        Pass {
            Cull Back
            SetTexture [_MainTex] {
                Combine Primary * Texture
            }
        }
    }
}
</code></pre>
<!-- area:graphics -->
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SL-Pass.html"></a></span><div class="tip">ShaderLab: Pass</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="SL-Blend.html"></a></span><div class="tip">ShaderLab: Blending</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2020 Unity Technologies. Publication Date: 2020-04-07.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
